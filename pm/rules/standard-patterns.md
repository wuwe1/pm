# 命令标准模式

本规则定义所有 PM 命令应遵循的通用模式，确保一致性和简洁性。

## 核心原则

1. **快速失败（Fail Fast）** — 检查关键前提，然后执行
2. **信任系统** — 不过度验证不太可能失败的事情
3. **清晰报错** — 失败时明确说明原因和修复方法
4. **精简输出** — 只展示重要信息

## 时间戳获取

```bash
date -u +"%Y-%m-%dT%H:%M:%SZ"
```

必须使用真实系统时间，严禁占位符。

## Frontmatter 剥离

创建 GitHub Issue 时需要剥离文件的 YAML frontmatter：

```bash
sed '1,/^---$/d; 1,/^---$/d' file.md
```

## 错误消息格式

简短且可操作：

```
❌ {失败原因}：{解决方案}
```

示例：
- `❌ Epic 未找到：运行 /pm:prd-parse feature-name`
- `❌ GitHub CLI 失败：运行 gh auth login`

## 成功输出格式

```
✅ {操作} 完成
  - {关键结果 1}
  - {关键结果 2}
下一步：{建议的下一个操作}
```

## 前置检查模式

只检查绝对必要的前提：

```markdown
## 前置检查
1. 目标文件/目录是否存在？
2. 执行操作
3. 优雅地处理失败
```

**不要**：
- 预检查权限
- 预检查 GitHub 认证
- 预检查 API 限额
- 验证每一个字段

## 文件操作

```bash
# 直接创建所需目录
mkdir -p .claude/{directory} 2>/dev/null
```

## 状态指示符

- ✅ 成功（节制使用）
- ❌ 错误（必须附带解决方案）
- ⚠️ 警告（仅在需要操作时使用）
- 普通信息不加 emoji

## 记住

**简洁不等于简陋** — 我们仍然正确处理错误，只是不试图预防每一种极端情况。信任文件系统、GitHub CLI 和 Git 仓库通常是正常的。聚焦正常路径，优雅处理异常。
